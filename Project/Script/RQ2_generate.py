import pandas as pd
import os

txt_folder_path = "C:\\Users\\shiha\\OneDrive - mail.sdu.edu.cn\\Desktop\\博士（论文）\\大模型工作\\种子数据集-50个场景\\"
output_path = "C:\\Users\\shiha\\OneDrive - mail.sdu.edu.cn\\Desktop\\博士（论文）\\大模型工作\\种子数据集-50个场景\\"


Instruction = """
你是一个领域信息抽取模型，你的下面是一些抽取实例：
第一个：
1、工艺生产方案：在汽车发动机铸造工艺的生产方案中，整个流程从原材料的准备到最终的铸件后处理，设计有一系列精细化管理的步骤和高度自动化的设备操作，旨在确保生产效率的最大化以及铸件质量的优化。这个方案特别强调了设备之间的协调工作以及基于事件的动态调度，以适应工业柔性生产的需求。\n首先，工艺流程启动于材料准备阶段，在这一阶段，使用电炉对铝合金或铁进行加热，直至材料融化。此过程中，电炉从待机状态(IDLE)经过加热(HEATING)阶段，维持在一个完成(COMPLETE)的状态，直至材料完全融化。电炉的关键属性包括最大温度和加热速率，它们决定了材料加热的效率和质量。\n随后，进入模具准备阶段，在这里数控机床根据提供的设计文件，精确地制作出用于铸造发动机的模具。数控机床的操作流程从接收设计文件开始，通过加工(PROCESSING)到最终的完成(COMPLETE)状态。加工精度和速度是数控机床的重要属性，直接影响模具的质量。\n进入铸造阶段时，铸造机将融化的材料注入准备好的模具中。铸造机操作从待机(IDLE)到铸造(CASTING)，然后进入冷却(COOLING)过程，最后完成(COMPLETE)铸造。铸造压力和冷却系统是铸造机的关键属性，它们确保了铸件的形状和内部结构。\n铸件清理阶段涉及使用喷砂机对铸件表面进行清理，去除砂粒和其他杂质。喷砂机从待机(IDLE)状态开始，进入清理(CLEANING)操作，并最终达到完成(COMPLETE)状态。喷砂强度和处理速度是喷砂机的主要属性，影响清理过程的效率和效果。\n铸件检验是通过3D扫描仪全面检测铸件，包括尺寸和表面质量的检测。3D扫描仪的操作从待机(IDLE)状态开始，到扫描(SCANNING)过程，最终完成(COMPLETE)检验。扫描精度和速度是3D扫描仪的关键属性，它们决定了检验的准确性和速度。\n最后，在后处理阶段，数控加工中心对铸件进行精加工，如钻孔和铣削。这一过程从待机(IDLE)状态开始，到加工(PROCESSING)，并最终完成(COMPLETE)。加工精度和速度是数控加工中心的重要属性，它们直接影响加工后铸件的质量和外观。\n整个生产方案通过精确的设备操作和基于事件的动态调度来实现高效率和高质量的铸造目标。每个设备的属性和状态管理是实现柔性生产和自动化的关键。此方案不仅体现了对铸造工艺流程的深入理解，也展示了在现代汽车发动机制造中追求技术创新和生产优化的努力。
2、问题：你是一个领域信息抽取模型，给定一个工艺场景的生产方案文本，请从给定的文本中根据用户提问的问题逐步抽取出领域知识。
3、答案：{\"name\": \"汽车发动机铸造\", \"contextList\": [{\"name\": \"材料准备\", \"entity\": [{\"name\": \"电炉\", \"namespace\": \"汽车发动机铸造.材料准备\", \"states\": [{\"state\": \"待机\", \"actions\": [], \"preEvent\": []}, {\"state\": \"加热\", \"actions\": [], \"preEvent\": [\"加热\", \"加热\"]}, {\"state\": \"完成\", \"actions\": [], \"preEvent\": [\"材料融化\"]}], \"cattr\": [\"最大温度\", \"加热速率\"]}, {\"name\": \"铝合金\", \"namespace\": \"汽车发动机铸造.材料准备\", \"states\": []}]}, {\"name\": \"模具准备\", \"entity\": [{\"name\": \"数控机床\", \"namespace\": \"汽车发动机铸造.模具准备\", \"states\": [{\"state\": \"完成\", \"actions\": [], \"preEvent\": [\"材料融化\"]}, {\"state\": \"加工\", \"actions\": [], \"preEvent\": [\"接收设计文件\"]}], \"cattr\": [\"加工精度\", \"速度\"]}, {\"name\": \"模具\", \"namespace\": \"汽车发动机铸造.模具准备\", \"states\": []}]}, {\"name\": \"铸造\", \"entity\": [{\"name\": \"铸造机\", \"namespace\": \"汽车发动机铸造.铸造\", \"states\": [{\"state\": \"待机\", \"actions\": [], \"preEvent\": []}, {\"state\": \"完成\", \"actions\": [], \"preEvent\": [\"材料融化\"]}, {\"state\": \"铸造\", \"actions\": [], \"preEvent\": [\"注入\"]}, {\"state\": \"冷却\", \"actions\": [], \"preEvent\": []}], \"cattr\": [\"铸造压力\", \"冷却\"]}, {\"name\": \"材料\", \"namespace\": \"汽车发动机铸造.铸造\", \"states\": []}, {\"name\": \"模具\", \"namespace\": \"汽车发动机铸造.铸造\", \"states\": []}]}, {\"name\": \"铸件清理\", \"entity\": [{\"name\": \"喷砂机\", \"namespace\": \"汽车发动机铸造.铸件清理\", \"states\": [{\"state\": \"待机\", \"actions\": [], \"preEvent\": []}, {\"state\": \"完成\", \"actions\": [], \"preEvent\": [\"材料融化\"]}, {\"state\": \"清理\", \"actions\": [], \"preEvent\": [\"清理\"]}], \"event\": \"清理\", \"cattr\": [\"喷砂强度\", \"处理速度\"]}]}, {\"name\": \"铸件检验\", \"entity\": [{\"name\": \"3D扫描仪\", \"namespace\": \"汽车发动机铸造.铸件检验\", \"states\": [{\"state\": \"待机\", \"actions\": [], \"preEvent\": []}, {\"state\": \"完成\", \"actions\": [], \"preEvent\": [\"材料融化\"]}, {\"state\": \"扫描\", \"actions\": [], \"preEvent\": [\"检测\"]}], \"event\": \"检测\", \"cattr\": [\"扫描精度\", \"速度\"]}]}]}
第二个：
1、工艺生产方案：在机械加工制造领域，线切割工艺是一种精密的加工方法，主要用于加工硬质材料或复杂形状的零件。整个生产方案从材料准备到最终检验，包含多个关键工序，每个工序涉及特定的设备、事件驱动、设备属性和状态，以及在各种状态下的操作。\n首先，材料准备阶段，需要一个自动上料系统将待加工材料送入工作区。该系统由传感器事件驱动，检测到工作台无材料时，自动上料机将新材料送入工作位置，设备状态从待机(IDLE)变为工作(WORKING)，完成上料后，系统自动返回待机状态，等待下一次上料指令。\n随后进入线切割加工阶段，线切割机接收到材料就绪信号后，根据预设程序启动，从待机状态(IDLE)转变为加工状态(PROCESSING)。线切割机设定的关键属性包括切割速度为5mm/s，精度为±0.01mm。在加工状态下，设备控制线丝按照预设路径进行切割，同时冷却系统工作以防止过热，切割过程由编码器事件驱动，实时调整切割路径以确保精度。完成切割后，线切割机移动到初始位置坐标(0,0)，准备下一次加工。\n接下来，清洗和干燥阶段，加工完成的零件由自动传送带送至清洗站，传送带工作5秒，速度设为1m/s，确保零件平稳到达。清洗站使用高压水枪清除零件表面的切割液和微小金属颗粒，设备在完成清洗后，通过压缩空气进行干燥处理，设备状态从清洗(WASHING)转为干燥(DRYING)，最后返回待机状态(IDLE)。\n最后，质量检验阶段，采用3D扫描仪对加工后的零件进行全面检测，从待机(IDLE)转变为检测状态(SCANNING)。扫描仪的属性包括扫描精度为±0.005mm，扫描速度为10mm/s。扫描仪对零件的尺寸和形状进行精确测量，确认是否满足设计要求。检验完成后，如果零件合格，将被自动分类至合格品区；如果不合格，则被送至返工或报废区，整个过程由质量检测系统的反馈事件驱动。\n通过上述工序的严格控制和设备的精确操作，线切割工艺生产方案能够高效且精确地完成复杂零件的加工任务，满足现代机械加工制造领域对零件质量和生产效率的高要求。每个工序的顺利进行都依赖于设备的精确控制和状态管理，确保了整个生产过程的高质量和高效率。
2、问题：你是一个领域信息抽取模型，给定一个工艺场景的生产方案文本，请从给定的文本中根据用户提问的问题逐步抽取出领域知识。
3、答案：{\"name\": \"线切割\", \"contextList\": [{\"name\": \"材料准备\", \"entity\": [{\"name\": \"自动上料系统\", \"namespace\": \"线切割.材料准备\", \"states\": [{\"state\": \"待机\", \"actions\": [], \"preEvent\": [\"完成上料\"]}, {\"state\": \"工作\", \"actions\": [{\"action\": \"新材料送入\", \"params\": [\"工作位置\"]}], \"preEvent\": [\"工作台无材料\"]}]}]}, {\"name\": \"线切割加工\", \"entity\": [{\"name\": \"线切割机\", \"namespace\": \"线切割.线切割加工\", \"states\": [{\"state\": \"待机\", \"actions\": [], \"preEvent\": [\"完成上料\"]}, {\"state\": \"加工\", \"actions\": [{\"action\": \"冷却\", \"params\": []}, {\"action\": \"冷却\", \"params\": []}], \"preEvent\": [\"编码器事件\"]}], \"cattr\": [\"切割速度\", \"精度\"]}]}, {\"name\": \"清洗和干燥\", \"entity\": [{\"name\": \"加工完成的零\", \"namespace\": \"线切割.清洗和干燥\", \"states\": []}, {\"name\": \"清洗站\", \"namespace\": \"线切割.清洗和干燥\", \"states\": [{\"state\": \"待机\", \"actions\": [], \"preEvent\": [\"完成上料\"]}, {\"state\": \"清洗\", \"actions\": [{\"action\": \"清洗\", \"params\": []}], \"preEvent\": [\"加工完成\"]}, {\"state\": \"干燥\", \"actions\": [{\"action\": \"干燥\", \"params\": []}], \"preEvent\": [\"完成清洗\"]}]}, {\"name\": \"传送带\", \"namespace\": \"线切割.清洗和干燥\", \"states\": [{\"state\": \"工作\", \"actions\": [{\"action\": \"新材料送入\", \"params\": [\"工作位置\"]}], \"preEvent\": [\"工作台无材料\"]}]}]}, {\"name\": \"质量检验\", \"entity\": [{\"name\": \"3D扫描仪\", \"namespace\": \"线切割.质量检验\", \"states\": []}, {\"name\": \"加工后的零件\", \"namespace\": \"线切割.质量检验\", \"states\": [{\"state\": \"待机\", \"actions\": [], \"preEvent\": [\"完成上料\"]}, {\"state\": \"检测\", \"actions\": [{\"action\": \"测量\", \"params\": [\"形状\", \"零件的尺寸\"]}], \"preEvent\": []}], \"cattr\": [\"扫描精度\", \"扫描速度\"]}]}]}
第三个：
1、工艺生产方案：在医疗设备制造领域，生物兼容性涂层工艺是一项关键技术，用于确保医疗设备在接触人体时的安全性和功能性。该工艺包括几个主要工序，涉及到一系列精密设备的协同工作。首先是表面准备工序，这一步使用砂带机和喷砂机对医疗设备表面进行打磨和清洁，以确保涂层的良好附着。砂带机在待机状态（IDLE）接收到工件放置信号后，以2m/s的速度运转5秒，对工件进行初步打磨；随后喷砂机在2.5bar的压力下喷砂10秒，彻底清理工件表面。接着进入到涂层制备工序，其中涂层混合设备在接收到配方参数后，自动混合生物兼容性涂料，混合过程持续30秒，以确保涂层的均匀性和稳定性。\n随后，工件被送至自动喷涂系统，这个系统通过精确控制喷涂参数（如喷枪移动速度0.5m/s，喷涂距离15cm）在工件表面均匀施加涂层，喷涂过程大约持续20秒。喷涂完成后，工件通过输送带（以1m/s的速度运行）送入烘干隧道，烘干隧道在60℃下工作30分钟，以确保涂层的完全固化。最后，工件进入到质量检验工序，使用3D扫描仪和光学显微镜对涂层的均匀性、厚度（目标为0.5mm）进行检测，检测过程大约持续15秒，确保每件产品都符合医疗安全标准。\n整个生物兼容性涂层工艺流程高度自动化，每一步均由精确的事件驱动，如工件到位信号、配方参数输入等，确保了工艺的高效和产品的一致性。设备的每种状态下都有明确的操作指令，从而实现了对整个生产流程的精确控制。这种高度集成和自动化的生产方案不仅提高了生产效率，还保证了医疗设备表面涂层的高品质，满足了医疗行业对产品安全性和功能性的严格要求。
2、问题：你是一个领域信息抽取模型，给定一个工艺场景的生产方案文本，请从给定的文本中根据用户提问的问题逐步抽取出领域知识。
3、答案：{\"name\": \"生物兼容性涂层\", \"contextList\": [{\"name\": \"表面准备\", \"entity\": [{\"name\": \"砂带机\", \"namespace\": \"生物兼容性涂层.表面准备\", \"states\": [{\"state\": \"待机\", \"actions\": [], \"preEvent\": []}, {\"state\": \"运转\", \"actions\": [{\"action\": \"打磨\", \"params\": [\"速度\"]}], \"preEvent\": [\"工件放置\"]}]}, {\"name\": \"医疗设备\", \"namespace\": \"生物兼容性涂层.表面准备\", \"states\": []}, {\"name\": \"喷砂机\", \"namespace\": \"生物兼容性涂层.表面准备\", \"states\": [{\"state\": \"喷砂\", \"actions\": [{\"action\": \"喷砂\", \"params\": [\"压力\"]}], \"preEvent\": []}]}]}, {\"name\": \"涂层制备\", \"entity\": [{\"name\": \"涂层混合设备\", \"namespace\": \"生物兼容性涂层.涂层制备\", \"states\": [{\"state\": \"混合\", \"actions\": [{\"action\": \"混合生物兼容性涂料\", \"params\": [\"持续\"]}], \"preEvent\": [\"接收到配方参数\"]}]}, {\"name\": \"喷涂系统\", \"namespace\": \"生物兼容性涂层.涂层制备\", \"states\": [{\"state\": \"喷涂\", \"actions\": [{\"action\": \"涂层\", \"params\": [\"喷枪移动速度\", \"喷涂距离\", \"持续\"]}], \"preEvent\": []}]}, {\"name\": \"输送带\", \"namespace\": \"生物兼容性涂层.涂层制备\", \"states\": [{\"state\": \"送\", \"actions\": [{\"action\": \"送入\", \"params\": []}], \"preEvent\": [\"喷涂完成\"]}]}, {\"name\": \"烘干隧道\", \"namespace\": \"生物兼容性涂层.涂层制备\", \"states\": [{\"state\": \"工作\", \"actions\": [{\"action\": \"固化\", \"params\": []}], \"preEvent\": []}]}]}, {\"name\": \"质量检验\", \"entity\": [{\"name\": \"3D扫描仪\", \"namespace\": \"生物兼容性涂层.质量检验\", \"states\": [{\"state\": \"检测\", \"actions\": [{\"action\": \"检测\", \"params\": [\"持续\", \"标准\"]}], \"preEvent\": []}]}, {\"name\": \"光学显微镜\", \"namespace\": \"生物兼容性涂层.质量检验\", \"states\": []}, {\"name\": \"涂层\", \"namespace\": \"生物兼容性涂层.质量检验\", \"states\": [], \"cattr\": [\"均匀性\", \"厚度\"]}]}]}
请参考上面三个实例中问题与回答的内容和形式（请按照给出示例的答案的模板和形式进行回答，不要只回答一个单独的字符串”），对下面的工艺生产方案进行相应信息的抽取：“{input}”。
"""
txt_data = []

# 遍历指定文件夹中的所有txt文件
for file_name in os.listdir(txt_folder_path):
    if file_name.endswith('.txt'):
        file_path = os.path.join(txt_folder_path, file_name)
        with open(file_path, 'r', encoding='utf-8') as file:
            content = file.read()
            # 去掉回车得到Input
            input_text = content.replace('\n', ' ')

            # 提取Domain
            first_sentence = content.split('.')[0]
            domain = first_sentence.split('工艺生产方案')[0] if '工艺生产方案' in first_sentence else first_sentence.split('工艺')[0][1:]

            # 收集数据
            txt_data.append({'Domain': domain, 'Instruction': Instruction, 'Input': input_text})


df = pd.DataFrame(txt_data)
print(df)
# df = pd.read_excel('C:\\Users\\shiha\\OneDrive - mail.sdu.edu.cn\\Desktop\\博士（论文）\\大模型工作\\评测\\Test_RQ1.xlsx', sheet_name='Sheet1')

# 写入Excel文件
df.to_excel(output_path+'output_excel_path.xlsx', index=False)
